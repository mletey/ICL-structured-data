mkdir: cannot create directory ‘runs/softmaxonly_40fullrun’: File exists
mkdir: cannot create directory ‘runs/softmaxonly_40fullrun/pickles’: File exists
2025-06-17 22:05:51.827781: E external/xla/xla/stream_executor/stream.cc:332] Error recording event in stream: Error recording CUDA event: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered; not marking stream as bad, as the Event object may be at fault. Monitor for further errors.
2025-06-17 22:05:51.829061: E external/xla/xla/stream_executor/cuda/cuda_executor.cc:810] failed to record completion event; therefore, failed to create inter-stream dependency
2025-06-17 22:05:51.829076: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1872] could not wait stream on event: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:51.829102: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1437] unable to add host callback: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:51.829114: E external/xla/xla/stream_executor/stream.cc:928] Error waiting for event in stream: error recording waiting for CUDA event on stream 0x55d18a74fbf0; not marking stream as bad, as the Event object may be at fault. Monitor for further errors.
2025-06-17 22:05:51.829207: W external/xla/xla/service/gpu/runtime/support.cc:58] Intercepted XLA runtime error:
INTERNAL: CaptureGpuGraph failed (<no details>): INTERNAL: Failed to begin stream capture: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:51.829235: E external/xla/xla/pjrt/pjrt_stream_executor_client.cc:2732] Execution of replica 0 failed: INTERNAL: Failed to execute XLA Runtime executable: run time error: custom call 'xla.gpu.graph.launch' failed: CaptureGpuGraph failed (<no details>): INTERNAL: Failed to begin stream capture: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered; current tracing scope: cuda_graph/xla.gpu.graph.capture; current profiling annotation: XlaModule:#prefix=jit(train_step)/jit(main),hlo_module=jit_train_step,program_id=178#.
Traceback (most recent call last):
  File "/n/netscratch/pehlevan_lab/Lab/ml/ICL-structured-data/NONLINEAR/experiment/remote/kappasweep_neurips/kappasweep.py", line 43, in <module>
    state, hist = train(config, data_iter=iter(trainobject), test_1_iter=iter(testobject_1), test_2_iter=iter(testobject_2), batch_size=16, loss='mse', test_every=100, train_iters=1000, optim=optax.adamw,lr=1e-4)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/netscratch/pehlevan_lab/Lab/ml/ICL-structured-data/NONLINEAR/experiment/remote/kappasweep_neurips/../../../trainmini.py", line 186, in train
    state = train_step(state, minibatchi, loss=loss, l1_weight=l1_weight, l2_weight=l2_weight)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: INTERNAL: Failed to execute XLA Runtime executable: run time error: custom call 'xla.gpu.graph.launch' failed: CaptureGpuGraph failed (<no details>): INTERNAL: Failed to begin stream capture: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered; current tracing scope: cuda_graph/xla.gpu.graph.capture; current profiling annotation: XlaModule:#prefix=jit(train_step)/jit(main),hlo_module=jit_train_step,program_id=178#.
2025-06-17 22:05:52.005944: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b304fc0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.007090: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b4d9760; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.009382: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e5d26f0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.010397: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e3edd30; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.011812: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18ea62130; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.012596: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e7c5d40; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.013485: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18ed8f2b0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.014361: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e9adb80; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.015870: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18de11fc0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.016476: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18df60ab0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.017014: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18df413c0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.017587: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e005b90; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.018198: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e261780; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.018683: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e0aba20; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.019488: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18ed55f00; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.019806: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18ed9f1b0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.020543: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e079920; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.020811: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18efa7af0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.021459: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18f125c20; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.022087: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18dd624d0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.022562: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b3619e0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.023665: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18f7be3a0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.024031: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18db7f320; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.024502: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18f801e60; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.025155: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18f98e2c0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.025837: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18faf6770; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.026391: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18f936dd0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.026904: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18fc5cf80; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.027503: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18f066560; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.028071: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18fe0c330; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.028774: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b7767c0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.029744: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18bbd8550; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.030092: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e393070; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.030283: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b34ba30; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.030780: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18fd2cc30; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.031277: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b26df30; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.101142: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b792da0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.101905: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18f532980; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.105304: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18ef0ff10; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.105460: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18b509e80; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
2025-06-17 22:05:52.105627: E external/xla/xla/stream_executor/cuda/cuda_driver.cc:1486] failed to unload module 0x55d18e4108b0; leaking: CUDA_ERROR_ILLEGAL_INSTRUCTION: an illegal instruction was encountered
